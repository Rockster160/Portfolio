<% required ||= false %>
<% current_option = stack.squish.split(" ").last %>
<div class="options-container hidden" data-option-stack="<%= stack %>" data-required="<%= required %>" data-combine-options="<%= combine_nested_options?(current_option) %>">
  <% (options.try(:keys) || options).each do |option| %>
    <% new_stack = "#{stack} #{option.to_s}".squish %>
    <div class="option" data-option-stack="<%= new_stack %>" data-bottom-stack="<%= !options.is_a?(Hash) %>" data-top-stack="<%= stack.blank? %>">
      <% case option %>
      <% when "male" %>
        <i class="fa fa-mars"></i>
      <% when "female" %>
        <i class="fa fa-venus"></i>
      <% else %>
        <span><%= option.titleize %></span>
      <% end %>
    </div>
  <% end %>

  <% if options.is_a?(Hash) %>
    <% options.each do |option_key, option_values| %>
      <% new_stack = "#{stack} #{option_key.to_s}".squish %>
      <%= render partial: "option", locals: { options: option_values, stack: new_stack, required: CharacterBuilder.required_placements.include?(option_key) } %>
    <% end %>
  <% end %>
</div>
