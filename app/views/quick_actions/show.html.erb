<% content_for(:head) do %>
  <link rel="manifest" href="/jarvis.webmanifest">
<% end %>

<% content_for(:favicon) do %>
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#00102B">
  <link rel="shortcut icon" href="/favicon/favicon.ico">
  <meta name="msapplication-TileColor" content="#00102B">
  <meta name="msapplication-config" content="/favicon/browserconfig.xml">
  <meta name="theme-color" content="#00102B">
<% end %>

<div class="widget-wrapper main-wrapper" data-update-url="<%= jarvis_page_path %>">
  <% @page.blocks.each do |widget_data| %>
    <%= render partial: widget_data[:type], locals: { widget_data: widget_data } %>
  <% end %>
</div>

<div class="settings">
  <a href="#" class="btn" data-mode="add">Add</a>
  <a href="#" class="btn" data-mode="move">Move</a>
  <a href="#" class="btn" data-mode="delete">Delete</a>
</div>

<% locals_data = { widget_data: { name: "{{widget_name}}", display: "{{widget_display}}" }, modal_id: "{{modal_id}}" } %>
<!-- Main Widget -->
<template id="template-main-widget">
  <%= widget(locals_data) %>
</template>
<!-- Modal -->
<template id="template-modal">
  <%= render partial: "mini_widget_modal", locals: locals_data %>
</template>
<!-- Mini Widget -->
<template id="template-mini-widget">
  <%= render partial: "mini_widget", locals: { item: { name: "{{item_name}}", display: "{{item_display}}", command: "{{item_command}}" } } %>
</template>
