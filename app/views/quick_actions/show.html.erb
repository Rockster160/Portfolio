<% content_for(:head) do %>
  <link rel="manifest" href="/jarvis.webmanifest">
<% end %>

<% content_for(:favicon) do %>
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#00102B">
  <link rel="shortcut icon" href="/favicon/favicon.ico">
  <meta name="msapplication-TileColor" content="#00102B">
  <meta name="msapplication-config" content="/favicon/browserconfig.xml">
  <meta name="theme-color" content="#00102B">
<% end %>

<div class="widget-wrapper main-wrapper">
  <% current_user.jarvis_page.blocks.each do |widget| %>
    <% if widget.key?(:type) %>
      <%= render partial: widget[:type] %>
    <% else %>
      <%= mini_widgets(widget) %>
    <% end %>
  <% end %>
</div>

<div class="settings">
  <a href="#" class="btn" data-mode="add">Add</a>
  <a href="#" class="btn" data-mode="move">Move</a>
  <a href="#" class="btn" data-mode="delete">Delete</a>
</div>

<% content_for :modals do %>
  <div class="modal" id="settings-modal" tabindex="-1">
    <i class="ti ti-oct-gear settings-open" data-modal="settings-modal"></i>
    <div class="close">
      <i class="ti ti-fa-close"></i>
    </div>
    <div class="modal-content">
      <div class="settings-wrapper">

      </div>
    </div>
  </div>
<% end %>

<% local_data = { widget: { name: "{{widget_name}}" }, modal_id: "{{modal_id}}" } %>
<!-- Main Widget -->
<template id="template-main-widget">
  <%= render partial: "main_widget", locals: local_data %>
</template>
<!-- Modal -->
<template id="template-modal">
  <%= render partial: "mini_widget_modal", locals: local_data %>
</template>
<!-- Mini Widget -->
<template id="template-mini-widget">
  <%= render partial: "mini_widget", locals: { item: { name: "{{item_name}}", command: "{{item_command}}" } } %>
</template>
